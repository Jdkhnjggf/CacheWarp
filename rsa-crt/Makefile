all: main fault run

IPP_BUILD_INCLUDE=./include
IPP_BUILD_LIB=./lib

MSG="0x1253E04DC0A5397BB44A7AB87E9BF2A039A33D1E996FC82A94CCD30074C95DF763722017069E5268DA5D1C0B4F872CF653C11DF82314A67968DFEAE28DEF04BB6D84B1C31D654A1970E5783BD6EB96A024C2CA2F4A90FE9F2EF5C9C140E5BB48DA9536AD8700C84FC9130ADEA74E558D51A74DDF85D8B50DE96838D6063E0955"

main: main.c
	$(CC) $< -O0 -no-pie -g -lcrypto_mb -lippcp -I../ -I$(IPP_BUILD_INCLUDE) -L$(IPP_BUILD_LIB) -o main

fault: main_fault.c
	$(CC) $< -O0 -no-pie -g -lcrypto_mb -lippcp -I../ -I$(IPP_BUILD_INCLUDE) -L$(IPP_BUILD_LIB) -o fault

run: main
	LD_LIBRARY_PATH=$(IPP_BUILD_LIB) ./main $(MSG) signature.clean

exploit: fault
	LD_LIBRARY_PATH=$(IPP_BUILD_LIB) ./fault $(MSG) signature.corrupted

clean:
	rm -f main fault
